ТекстЗапроса = "ВЫБРАТЬ
               |	DR_Документы.Ссылка КАК Ссылка,
               |	DR_Документы.Дата КАК Дата,
               |	DR_Документы.ИдентификаторДокумента КАК ИдентификаторДокумента,
               |	DR_ДокументыДополнительныеРеквизиты_Грузоотправитель.Значение КАК Грузоотправитель,
               |	DR_ДокументыДополнительныеРеквизиты_Грузополучатель.Значение КАК Грузополучатель,
               |	DR_ДокументыДополнительныеРеквизиты_Грузоперевозчик.Значение КАК Грузоперевозчик,
               |	DR_ДокументыДополнительныеРеквизиты_Организация.Значение КАК Организация,
               |	DR_Документы.Статус КАК Статус,
               |	ВЫРАЗИТЬ(DR_ДокументыДополнительныеРеквизиты_ДатаЭТРН.Значение КАК ДАТА) КАК ДатаЭТРН,
               |	DR_ДокументыДополнительныеРеквизиты_НомерЭТРН.Значение КАК НомерЭТРН
               |ПОМЕСТИТЬ ВТ_ON_TRNACLGROT
               |ИЗ
               |	Документ.DR_Документы КАК DR_Документы
               |		ЛЕВОЕ СОЕДИНЕНИЕ Документ.DR_Документы.ДополнительныеРеквизиты КАК DR_ДокументыДополнительныеРеквизиты_Грузоотправитель
               |		ПО DR_Документы.Ссылка = DR_ДокументыДополнительныеРеквизиты_Грузоотправитель.Ссылка
               |			И (DR_ДокументыДополнительныеРеквизиты_Грузоотправитель.Реквизит = ""Грузоотправитель"")
               |		ЛЕВОЕ СОЕДИНЕНИЕ Документ.DR_Документы.ДополнительныеРеквизиты КАК DR_ДокументыДополнительныеРеквизиты_Грузополучатель
               |		ПО DR_Документы.Ссылка = DR_ДокументыДополнительныеРеквизиты_Грузополучатель.Ссылка
               |			И (DR_ДокументыДополнительныеРеквизиты_Грузополучатель.Реквизит = ""Грузополучатель"")
               |		ЛЕВОЕ СОЕДИНЕНИЕ Документ.DR_Документы.ДополнительныеРеквизиты КАК DR_ДокументыДополнительныеРеквизиты_Грузоперевозчик
               |		ПО DR_Документы.Ссылка = DR_ДокументыДополнительныеРеквизиты_Грузоперевозчик.Ссылка
               |			И (DR_ДокументыДополнительныеРеквизиты_Грузоперевозчик.Реквизит = ""Грузоперевозчик"")
               |		ЛЕВОЕ СОЕДИНЕНИЕ Документ.DR_Документы.ДополнительныеРеквизиты КАК DR_ДокументыДополнительныеРеквизиты_Организация
               |		ПО DR_Документы.Ссылка = DR_ДокументыДополнительныеРеквизиты_Организация.Ссылка
               |			И (DR_ДокументыДополнительныеРеквизиты_Организация.Реквизит = ""Организация"")
			   |		ЛЕВОЕ СОЕДИНЕНИЕ Документ.DR_Документы.ДополнительныеРеквизиты КАК DR_ДокументыДополнительныеРеквизиты_ДатаЭТРН
               |		ПО DR_Документы.Ссылка = DR_ДокументыДополнительныеРеквизиты_ДатаЭТРН.Ссылка
               |			И (DR_ДокументыДополнительныеРеквизиты_ДатаЭТРН.Реквизит = ""ТранспортнаяНакладнаяДата"")
               |		ЛЕВОЕ СОЕДИНЕНИЕ Документ.DR_Документы.ДополнительныеРеквизиты КАК DR_ДокументыДополнительныеРеквизиты_НомерЭТРН
               |		ПО DR_Документы.Ссылка = DR_ДокументыДополнительныеРеквизиты_НомерЭТРН.Ссылка
               |			И (DR_ДокументыДополнительныеРеквизиты_НомерЭТРН.Реквизит = ""ТранспортнаяНакладнаяНомер"")
               |ГДЕ
               |	DR_Документы.ВидДокумента = ""ON_TRNACLGROT_Входящий""
               |	И НЕ DR_Документы.ПометкаУдаления
               |;
               |
               |////////////////////////////////////////////////////////////////////////////////
               |ВЫБРАТЬ
               |	DR_Документы.Ссылка КАК Ссылка,
               |	DR_Документы.ИдентификаторДокумента КАК ИдентификаторДокумента,
               |	DR_Документы.ИдентификаторЦепочки КАК ИдентификаторЦепочки,
               |	DR_ДокументыДополнительныеРеквизиты_ИдОсн.Значение КАК ИдентификаторОснования,
               |	DR_Документы.Статус КАК Статус,
               |	DR_ДокументыДополнительныеРеквизиты_ДопИнфAperak.Значение КАК ДополнительнаяИнформация_aperakETRN
               |ПОМЕСТИТЬ ВТ_ON_TRNACLPPRIN
               |ИЗ
               |	Документ.DR_Документы КАК DR_Документы
               |		ЛЕВОЕ СОЕДИНЕНИЕ Документ.DR_Документы.ДополнительныеРеквизиты КАК DR_ДокументыДополнительныеРеквизиты_ИдОсн
               |		ПО DR_Документы.Ссылка = DR_ДокументыДополнительныеРеквизиты_ИдОсн.Ссылка
               |			И (DR_ДокументыДополнительныеРеквизиты_ИдОсн.Реквизит = ""ИдентификаторОснования"")
               |		ЛЕВОЕ СОЕДИНЕНИЕ Документ.DR_Документы.ДополнительныеРеквизиты КАК DR_ДокументыДополнительныеРеквизиты_ДопИнфAperak
               |		ПО DR_Документы.Ссылка = DR_ДокументыДополнительныеРеквизиты_ДопИнфAperak.Ссылка
               |			И (DR_ДокументыДополнительныеРеквизиты_ДопИнфAperak.Реквизит = ""ДополнительнаяИнформация_aperakETRN"")
               |ГДЕ
               |	DR_Документы.ВидДокумента = ""ON_TRNACLPPRIN_Исходящий""
               |	И НЕ DR_Документы.ПометкаУдаления
               |;
               |
               |////////////////////////////////////////////////////////////////////////////////
               |ВЫБРАТЬ
               |	DR_Документы.Ссылка КАК Ссылка,
               |	DR_Документы.ИдентификаторДокумента КАК ИдентификаторДокумента,
               |	DR_Документы.ИдентификаторЦепочки КАК ИдентификаторЦепочки,
               |	DR_ДокументыДополнительныеРеквизиты_ИдОсн.Значение КАК ИдентификаторОснования,
               |	DR_Документы.Статус КАК Статус
               |ПОМЕСТИТЬ ВТ_ON_TRNACLGRPO
               |ИЗ
               |	Документ.DR_Документы КАК DR_Документы
               |		ЛЕВОЕ СОЕДИНЕНИЕ Документ.DR_Документы.ДополнительныеРеквизиты КАК DR_ДокументыДополнительныеРеквизиты_ИдОсн
               |		ПО DR_Документы.Ссылка = DR_ДокументыДополнительныеРеквизиты_ИдОсн.Ссылка
               |			И (DR_ДокументыДополнительныеРеквизиты_ИдОсн.Реквизит = ""Документ_ИдИнфПрвПрием_ИдФайлИнфПрвПрием"")
               |ГДЕ
               |	DR_Документы.ВидДокумента = ""ON_TRNACLGRPO_Входящий""
               |	И НЕ DR_Документы.ПометкаУдаления
               |;
               |
               |////////////////////////////////////////////////////////////////////////////////
               |ВЫБРАТЬ
               |	DR_Документы.Ссылка КАК Ссылка,
               |	DR_Документы.ИдентификаторДокумента КАК ИдентификаторДокумента,
               |	DR_Документы.ИдентификаторЦепочки КАК ИдентификаторЦепочки,
               |	DR_ДокументыДополнительныеРеквизиты_ИдОсн.Значение КАК ИдентификаторОснования,
               |	DR_Документы.Статус КАК Статус,
               |	DR_ДокументыДополнительныеРеквизиты_ДопИнфAperak.Значение КАК ДополнительнаяИнформация_aperakETRN
               |ПОМЕСТИТЬ ВТ_ON_TRNACLPVYN
               |ИЗ
               |	Документ.DR_Документы КАК DR_Документы
               |		ЛЕВОЕ СОЕДИНЕНИЕ Документ.DR_Документы.ДополнительныеРеквизиты КАК DR_ДокументыДополнительныеРеквизиты_ИдОсн
               |		ПО DR_Документы.Ссылка = DR_ДокументыДополнительныеРеквизиты_ИдОсн.Ссылка
               |			И (DR_ДокументыДополнительныеРеквизиты_ИдОсн.Реквизит = ""ИдентификаторОснования"")
               |		ЛЕВОЕ СОЕДИНЕНИЕ Документ.DR_Документы.ДополнительныеРеквизиты КАК DR_ДокументыДополнительныеРеквизиты_ДопИнфAperak
               |		ПО DR_Документы.Ссылка = DR_ДокументыДополнительныеРеквизиты_ДопИнфAperak.Ссылка
               |			И (DR_ДокументыДополнительныеРеквизиты_ДопИнфAperak.Реквизит = ""ДополнительнаяИнформация_aperakETRN"")
               |ГДЕ
               |	DR_Документы.ВидДокумента = ""ON_TRNACLPVYN_Исходящий""
               |	И НЕ DR_Документы.ПометкаУдаления
               |;
               |
               |////////////////////////////////////////////////////////////////////////////////
               |ВЫБРАТЬ
               |	DR_Документы.Ссылка КАК Ссылка,
               |	DR_Документы.ИдентификаторДокумента КАК ИдентификаторДокумента,
               |	DR_Документы.ИдентификаторЦепочки КАК ИдентификаторЦепочки,
               |	DR_ДокументыДополнительныеРеквизиты_ИдОсн.Значение КАК ИдентификаторОснования,
               |	DR_Документы.Статус КАК Статус,
               |	DR_ДокументыДополнительныеРеквизиты_ДопИнфAperak.Значение КАК ДополнительнаяИнформация_aperakETRN
               |ПОМЕСТИТЬ ВТ_DP_UVUTOCH_Исх
               |ИЗ
               |	Документ.DR_Документы КАК DR_Документы
               |		ЛЕВОЕ СОЕДИНЕНИЕ Документ.DR_Документы.ДополнительныеРеквизиты КАК DR_ДокументыДополнительныеРеквизиты_ИдОсн
               |		ПО DR_Документы.Ссылка = DR_ДокументыДополнительныеРеквизиты_ИдОсн.Ссылка
               |			И (DR_ДокументыДополнительныеРеквизиты_ИдОсн.Реквизит = ""ИдентификаторОснования"")
               |		ЛЕВОЕ СОЕДИНЕНИЕ Документ.DR_Документы.ДополнительныеРеквизиты КАК DR_ДокументыДополнительныеРеквизиты_ДопИнфAperak
               |		ПО DR_Документы.Ссылка = DR_ДокументыДополнительныеРеквизиты_ДопИнфAperak.Ссылка
               |			И (DR_ДокументыДополнительныеРеквизиты_ДопИнфAperak.Реквизит = ""ДополнительнаяИнформация_aperakETRN"")
               |ГДЕ
               |	DR_Документы.ВидДокумента = ""DP_UVUTOCH_Исходящий""
               |	И НЕ DR_Документы.ПометкаУдаления
               |;
               |
               |////////////////////////////////////////////////////////////////////////////////
               |ВЫБРАТЬ
               |	DR_Документы.Ссылка КАК Ссылка,
               |	DR_Документы.ИдентификаторДокумента КАК ИдентификаторДокумента,
               |	DR_Документы.ИдентификаторЦепочки КАК ИдентификаторЦепочки,
               |	DR_ДокументыДополнительныеРеквизиты_ИдОсн.Значение КАК ИдентификаторОснования,
               |	DR_Документы.Статус КАК Статус
               |ПОМЕСТИТЬ ВТ_DP_UVUTOCH_Вх
               |ИЗ
               |	Документ.DR_Документы КАК DR_Документы
               |		ЛЕВОЕ СОЕДИНЕНИЕ Документ.DR_Документы.ДополнительныеРеквизиты КАК DR_ДокументыДополнительныеРеквизиты_ИдОсн
               |		ПО DR_Документы.Ссылка = DR_ДокументыДополнительныеРеквизиты_ИдОсн.Ссылка
               |			И (DR_ДокументыДополнительныеРеквизиты_ИдОсн.Реквизит = ""Документ_СвУведУточ_СведПолФайл_ИмяПолФайла"")
               |ГДЕ
               |	DR_Документы.ВидДокумента = ""DP_UVUTOCH_Входящий""
               |	И НЕ DR_Документы.ПометкаУдаления
               |;
               |
               |////////////////////////////////////////////////////////////////////////////////
               |ВЫБРАТЬ
               |	DR_Документы.Ссылка КАК Ссылка,
               |	DR_Документы.Дата КАК Дата,
               |	DR_Документы.ИдентификаторДокумента КАК ИдентификаторДокумента,
               |	DR_Документы.ИдентификаторЦепочки КАК ИдентификаторЦепочки,
               |	DR_ДокументыДополнительныеРеквизиты_ИдОсн.Значение КАК ИдентификаторОснования,
               |	DR_Документы.Статус КАК Статус,
               |	DR_ДокументыДополнительныеРеквизиты_ДопИнфAperak.Значение КАК ДополнительнаяИнформация_aperakETRN
               |ПОМЕСТИТЬ ВТ_ON_TRNPEREADR
               |ИЗ
               |	Документ.DR_Документы КАК DR_Документы
               |		ЛЕВОЕ СОЕДИНЕНИЕ Документ.DR_Документы.ДополнительныеРеквизиты КАК DR_ДокументыДополнительныеРеквизиты_ИдОсн
               |		ПО DR_Документы.Ссылка = DR_ДокументыДополнительныеРеквизиты_ИдОсн.Ссылка
               |			И (DR_ДокументыДополнительныеРеквизиты_ИдОсн.Реквизит = ""ИдентификаторОснования"")
               |		ЛЕВОЕ СОЕДИНЕНИЕ Документ.DR_Документы.ДополнительныеРеквизиты КАК DR_ДокументыДополнительныеРеквизиты_ДопИнфAperak
               |		ПО DR_Документы.Ссылка = DR_ДокументыДополнительныеРеквизиты_ДопИнфAperak.Ссылка
               |			И (DR_ДокументыДополнительныеРеквизиты_ДопИнфAperak.Реквизит = ""ДополнительнаяИнформация_aperakETRN"")
               |ГДЕ
               |	DR_Документы.ВидДокумента = ""ON_TRNPEREADR_Исходящий""
               |	И НЕ DR_Документы.ПометкаУдаления
               |;
               |
               |////////////////////////////////////////////////////////////////////////////////
               |ВЫБРАТЬ
               |	DR_Документы.Ссылка КАК Ссылка,
               |	DR_Документы.Дата КАК Дата,
               |	DR_Документы.ИдентификаторДокумента КАК ИдентификаторДокумента,
               |	DR_Документы.ИдентификаторЦепочки КАК ИдентификаторЦепочки,
               |	DR_ДокументыДополнительныеРеквизиты_ИдОсн.Значение КАК ИдентификаторОснования,
               |	DR_Документы.Статус КАК Статус,
               |	DR_ДокументыДополнительныеРеквизиты_ДопИнфAperak.Значение КАК ДополнительнаяИнформация_aperakETRN
               |ПОМЕСТИТЬ ВТ_ON_TRNZAMEN
               |ИЗ
               |	Документ.DR_Документы КАК DR_Документы
               |		ЛЕВОЕ СОЕДИНЕНИЕ Документ.DR_Документы.ДополнительныеРеквизиты КАК DR_ДокументыДополнительныеРеквизиты_ИдОсн
               |		ПО DR_Документы.Ссылка = DR_ДокументыДополнительныеРеквизиты_ИдОсн.Ссылка
               |			И (DR_ДокументыДополнительныеРеквизиты_ИдОсн.Реквизит = ""ИдентификаторОснования"")
               |		ЛЕВОЕ СОЕДИНЕНИЕ Документ.DR_Документы.ДополнительныеРеквизиты КАК DR_ДокументыДополнительныеРеквизиты_ДопИнфAperak
               |		ПО DR_Документы.Ссылка = DR_ДокументыДополнительныеРеквизиты_ДопИнфAperak.Ссылка
               |			И (DR_ДокументыДополнительныеРеквизиты_ДопИнфAperak.Реквизит = ""ДополнительнаяИнформация_aperakETRN"")
               |ГДЕ
               |	DR_Документы.ВидДокумента = ""ON_TRNZAMEN_Исходящий""
               |	И НЕ DR_Документы.ПометкаУдаления
               |;
               |
               |////////////////////////////////////////////////////////////////////////////////
               |ВЫБРАТЬ
               |	DR_Документы.Ссылка КАК Ссылка,
               |	DR_Документы.ИдентификаторДокумента КАК ИдентификаторДокумента,
               |	DR_Документы.ИдентификаторЦепочки КАК ИдентификаторЦепочки,
               |	DR_ДокументыДополнительныеРеквизиты_ИдОсн.Значение КАК ИдентификаторОснования,
               |	DR_ДокументыДополнительныеРеквизиты_Документ1С.Значение КАК Накладная,
               |	DR_Документы.Статус КАК Статус,
               |	DR_ДокументыДополнительныеРеквизиты_ДопИнфAperak.Значение КАК ДополнительнаяИнформация_aperakETRN
               |ПОМЕСТИТЬ ВТ_ON_TRNPUDPER
               |ИЗ
               |	Документ.DR_Документы КАК DR_Документы
               |		ЛЕВОЕ СОЕДИНЕНИЕ Документ.DR_Документы.ДополнительныеРеквизиты КАК DR_ДокументыДополнительныеРеквизиты_ИдОсн
               |		ПО DR_Документы.Ссылка = DR_ДокументыДополнительныеРеквизиты_ИдОсн.Ссылка
               |			И (DR_ДокументыДополнительныеРеквизиты_ИдОсн.Реквизит = ""ИдентификаторОснования"")
               |		ЛЕВОЕ СОЕДИНЕНИЕ Документ.DR_Документы.ДополнительныеРеквизиты КАК DR_ДокументыДополнительныеРеквизиты_Документ1С
               |		ПО DR_Документы.Ссылка = DR_ДокументыДополнительныеРеквизиты_Документ1С.Ссылка
               |			И (DR_ДокументыДополнительныеРеквизиты_Документ1С.Реквизит = ""Документ1С"")
               |		ЛЕВОЕ СОЕДИНЕНИЕ Документ.DR_Документы.ДополнительныеРеквизиты КАК DR_ДокументыДополнительныеРеквизиты_ДопИнфAperak
               |		ПО DR_Документы.Ссылка = DR_ДокументыДополнительныеРеквизиты_ДопИнфAperak.Ссылка
               |			И (DR_ДокументыДополнительныеРеквизиты_ДопИнфAperak.Реквизит = ""ДополнительнаяИнформация_aperakETRN"")
               |ГДЕ
               |	DR_Документы.ВидДокумента = ""ON_TRNPUDPER_Исходящий""
               |	И НЕ DR_Документы.ПометкаУдаления
               |;
               |
               |////////////////////////////////////////////////////////////////////////////////
               |ВЫБРАТЬ
               |	DR_Документы.Ссылка КАК Ссылка,
               |	DR_Документы.ИдентификаторДокумента КАК ИдентификаторДокумента,
               |	DR_Документы.ИдентификаторЦепочки КАК ИдентификаторЦепочки,
               |	DR_ДокументыДополнительныеРеквизиты_ИдОсн.Значение КАК ИдентификаторОснования,
               |	DR_Документы.Статус КАК Статус
               |ПОМЕСТИТЬ ВТ_ON_TRNPUDGO
               |ИЗ
               |	Документ.DR_Документы КАК DR_Документы
               |		ЛЕВОЕ СОЕДИНЕНИЕ Документ.DR_Документы.ДополнительныеРеквизиты КАК DR_ДокументыДополнительныеРеквизиты_ИдОсн
               |		ПО DR_Документы.Ссылка = DR_ДокументыДополнительныеРеквизиты_ИдОсн.Ссылка
               |			И (DR_ДокументыДополнительныеРеквизиты_ИдОсн.Реквизит = ""Документ_ИдПУДИнфПрв_ИдФайлПУДИнфПрв"")
               |ГДЕ
               |	DR_Документы.ВидДокумента = ""ON_TRNPUDGO_Входящий""
               |	И НЕ DR_Документы.ПометкаУдаления
               |;
               |
               |////////////////////////////////////////////////////////////////////////////////
               |ВЫБРАТЬ
			   |    НАЧАЛОПЕРИОДА(DR_Документ.ДатаЭТРН, ДЕНЬ) КАК ДатаЭТРН,
               |    DR_Документ.НомерЭТРН КАК НомерЭТРН,
               |	ВЫБОР
               |		КОГДА НЕ DR_Документ_ON_TRNPUDGO_Входящий.Ссылка ЕСТЬ NULL
               |			ТОГДА DR_Документ_ON_TRNPUDGO_Входящий.Ссылка
               |		КОГДА НЕ DR_Документ_DP_UVUTOCH_Входящий.Ссылка ЕСТЬ NULL
               |			ТОГДА DR_Документ_DP_UVUTOCH_Входящий.Ссылка
               |		КОГДА НЕ DR_Документ_ON_TRNPUDPER_Исходящий.Ссылка ЕСТЬ NULL
               |			ТОГДА DR_Документ_ON_TRNPUDPER_Исходящий.Ссылка
               |		КОГДА НЕ DR_Документ_DP_UVUTOCH_Исходящий.Ссылка ЕСТЬ NULL
               |			ТОГДА DR_Документ_DP_UVUTOCH_Исходящий.Ссылка
               |		КОГДА НЕ DR_Документ_ON_TRNACLPVYN_Исходящий.Ссылка ЕСТЬ NULL
               |			ТОГДА DR_Документ_ON_TRNACLPVYN_Исходящий.Ссылка
               |		КОГДА НЕ DR_Документ_ON_TRNACLGRPO_Входящий.Ссылка ЕСТЬ NULL
               |			ТОГДА DR_Документ_ON_TRNACLGRPO_Входящий.Ссылка
               |		КОГДА НЕ DR_Документ_ON_TRNZAMEN_Исходящий.Ссылка ЕСТЬ NULL
               |			ТОГДА ВЫБОР
               |					КОГДА НЕ DR_Документ_ON_TRNPEREADR_Исходящий.Ссылка ЕСТЬ NULL
               |						ТОГДА ВЫБОР
               |								КОГДА DR_Документ_ON_TRNZAMEN_Исходящий.Дата > DR_Документ_ON_TRNPEREADR_Исходящий.Дата
               |									ТОГДА DR_Документ_ON_TRNZAMEN_Исходящий.Ссылка
               |								ИНАЧЕ DR_Документ_ON_TRNPEREADR_Исходящий.Ссылка
               |							КОНЕЦ
               |					ИНАЧЕ DR_Документ_ON_TRNZAMEN_Исходящий.Ссылка
               |				КОНЕЦ
               |		КОГДА НЕ DR_Документ_ON_TRNPEREADR_Исходящий.Ссылка ЕСТЬ NULL
               |			ТОГДА DR_Документ_ON_TRNPEREADR_Исходящий.Ссылка
               |		КОГДА НЕ DR_Документ_ON_TRNACLPPRIN_Исходящий.Ссылка ЕСТЬ NULL
               |			ТОГДА DR_Документ_ON_TRNACLPPRIN_Исходящий.Ссылка
               |		КОГДА НЕ DR_Документ.Ссылка ЕСТЬ NULL
               |			ТОГДА DR_Документ.Ссылка
               |	КОНЕЦ КАК Документ,
               |	ВЫБОР
               |		КОГДА НЕ DR_Документ_DP_UVUTOCH_Исходящий.Ссылка ЕСТЬ NULL
               |			ТОГДА DR_Документ_DP_UVUTOCH_Исходящий.Ссылка
               |		КОГДА НЕ DR_Документ_ON_TRNACLPVYN_Исходящий.Ссылка ЕСТЬ NULL
               |			ТОГДА DR_Документ_ON_TRNACLPVYN_Исходящий.Ссылка
               |		КОГДА НЕ DR_Документ_ON_TRNACLGRPO_Входящий.Ссылка ЕСТЬ NULL
               |			ТОГДА DR_Документ_ON_TRNACLGRPO_Входящий.Ссылка
               |		КОГДА НЕ DR_Документ_ON_TRNACLPPRIN_Исходящий.Ссылка ЕСТЬ NULL
               |			ТОГДА DR_Документ_ON_TRNACLPPRIN_Исходящий.Ссылка
               |		КОГДА НЕ DR_Документ.Ссылка ЕСТЬ NULL
               |			ТОГДА DR_Документ.Ссылка
               |	КОНЕЦ КАК Документ_Основание,
               |	ЕСТЬNULL(DR_Документ.Статус, """") КАК Статус_ON_TRNACLGROT_Входящий,
               |	ЕСТЬNULL(DR_Документ_ON_TRNACLPPRIN_Исходящий.Статус, """") КАК Статус_ON_TRNACLPPRIN_Исходящий,
               |	ЕСТЬNULL(DR_Документ_ON_TRNACLGRPO_Входящий.Статус, """") КАК Статус_ON_TRNACLGRPO_Входящий,
               |	ЕСТЬNULL(DR_Документ_ON_TRNACLPVYN_Исходящий.Статус, """") КАК Статус_ON_TRNACLPVYN_Исходящий,
               |	ЕСТЬNULL(DR_Документ_ON_TRNPEREADR_Исходящий.Статус, """") КАК Статус_ON_TRNPEREADR_Исходящий,
               |	ЕСТЬNULL(DR_Документ_ON_TRNZAMEN_Исходящий.Статус, """") КАК Статус_ON_TRNZAMEN_Исходящий,
               |	ВЫБОР
               |		КОГДА НЕ DR_Документ_DP_UVUTOCH_Входящий.Ссылка ЕСТЬ NULL
               |			ТОГДА DR_Документ_DP_UVUTOCH_Входящий.Статус
               |		ИНАЧЕ DR_Документ_DP_UVUTOCH_Исходящий.Статус
               |	КОНЕЦ КАК Статус_DP_UVUTOCH,
               |	ЕСТЬNULL(DR_Документ_ON_TRNPUDPER_Исходящий.Статус, """") КАК Статус_ON_TRNPUDPER_Исходящий,
               |	ЕСТЬNULL(DR_Документ_ON_TRNPUDGO_Входящий.Статус, """") КАК Статус_ON_TRNPUDGO_Входящий,
               |	DR_Документ.Дата КАК ДатаДокумента,
               |	ВЫБОР
               |		КОГДА DR_Документ_ON_TRNPUDGO_Входящий.Статус = ""Отклонен ГИС""
               |				ИЛИ DR_Документ_DP_UVUTOCH_Входящий.Статус = ""Отклонен ГИС""
               |				ИЛИ DR_Документ_ON_TRNPUDPER_Исходящий.Статус = ""Отклонен ГИС""
               |				ИЛИ DR_Документ_ON_TRNACLPVYN_Исходящий.Статус = ""Отклонен ГИС""
               |				ИЛИ DR_Документ_ON_TRNACLGRPO_Входящий.Статус = ""Отклонен ГИС""
               |				ИЛИ DR_Документ_DP_UVUTOCH_Исходящий.Статус = ""Отклонен ГИС""
               |				ИЛИ DR_Документ_ON_TRNPEREADR_Исходящий.Статус = ""Отклонен ГИС""
               |				ИЛИ DR_Документ_ON_TRNZAMEN_Исходящий.Статус = ""Отклонен ГИС""
               |				ИЛИ DR_Документ_ON_TRNACLPPRIN_Исходящий.Статус = ""Отклонен ГИС""
               |				ИЛИ DR_Документ.Статус = ""Отклонен ГИС""
               |			ТОГДА ""Отклонен ГИС""
               |		КОГДА ЕСТЬNULL(DR_Документ_ON_TRNPUDGO_Входящий.Статус, """") = ""Обработан""
               |				ИЛИ ЕСТЬNULL(DR_Документ_ON_TRNPUDGO_Входящий.Статус, """") = ""Принят ГИС""
               |			ТОГДА ""Стоимость подтверждена""
               |		КОГДА ЕСТЬNULL(DR_Документ_DP_UVUTOCH_Входящий.Статус, """") = ""Обработан""
               |				ИЛИ ЕСТЬNULL(DR_Документ_DP_UVUTOCH_Входящий.Статус, """") = ""Принят ГИС""
               |			ТОГДА ""Стоимость не подтверждена""
               |		КОГДА ЕСТЬNULL(DR_Документ_ON_TRNPUDPER_Исходящий.Статус, """") = ""Отправлен""
               |				ИЛИ ЕСТЬNULL(DR_Документ_ON_TRNPUDPER_Исходящий.Статус, """") = ""Принят ГИС""
               |			ТОГДА ""Объявлена стоимость перевозки""
               |		КОГДА ЕСТЬNULL(DR_Документ_ON_TRNACLPVYN_Исходящий.Статус, """") = ""Отправлен""
               |				ИЛИ ЕСТЬNULL(DR_Документ_ON_TRNACLPVYN_Исходящий.Статус, """") = ""Принят ГИС""
               |			ТОГДА ""Груз сдан перевозчиком""
               |		КОГДА ЕСТЬNULL(DR_Документ_ON_TRNACLGRPO_Входящий.Статус, """") = ""Обработан""
               |				ИЛИ ЕСТЬNULL(DR_Документ_ON_TRNACLGRPO_Входящий.Статус, """") = ""Принят ГИС""
               |			ТОГДА ""Груз принят получателем""
               |		КОГДА ЕСТЬNULL(DR_Документ_DP_UVUTOCH_Исходящий.Статус, """") = ""Отправлен""
               |				ИЛИ ЕСТЬNULL(DR_Документ_DP_UVUTOCH_Исходящий.Статус, """") = ""Принят ГИС""
               |			ТОГДА ""Перевозчик отклонил документ""
               |		КОГДА (ЕСТЬNULL(DR_Документ_ON_TRNPEREADR_Исходящий.Статус, """") = ""Отправлен""
               |				ИЛИ ЕСТЬNULL(DR_Документ_ON_TRNPEREADR_Исходящий.Статус, """") = ""Принят ГИС"")
		   |				И ЕСТЬNULL(DR_Документ_ON_TRNPEREADR_Исходящий.Дата, ДАТАВРЕМЯ(1, 1, 1)) > ЕСТЬNULL(DR_Документ_ON_TRNZAMEN_Исходящий.Дата, ДАТАВРЕМЯ(1, 1, 1))
               |			ТОГДА ""Груз переадресован""
               |		КОГДА ЕСТЬNULL(DR_Документ_ON_TRNZAMEN_Исходящий.Статус, """") = ""Отправлен""
               |				ИЛИ ЕСТЬNULL(DR_Документ_ON_TRNZAMEN_Исходящий.Статус, """") = ""Принят ГИС""
               |			ТОГДА ""Водитель/ТС заменены""
               |		КОГДА ЕСТЬNULL(DR_Документ_ON_TRNPEREADR_Исходящий.Статус, """") = ""Отправлен""
               |				ИЛИ ЕСТЬNULL(DR_Документ_ON_TRNPEREADR_Исходящий.Статус, """") = ""Принят ГИС""
               |			ТОГДА ""Груз переадресован""
               |		КОГДА ЕСТЬNULL(DR_Документ_ON_TRNACLPPRIN_Исходящий.Статус, """") = ""Отправлен""
               |				ИЛИ ЕСТЬNULL(DR_Документ_ON_TRNACLPPRIN_Исходящий.Статус, """") = ""Принят ГИС""
               |			ТОГДА ""Груз принят перевозчиком""
               |		КОГДА ЕСТЬNULL(DR_Документ.Статус, """") = ""Обработан""
               |				ИЛИ ЕСТЬNULL(DR_Документ.Статус, """") = ""Принят ГИС""
               |			ТОГДА ""Груз сдан отправителем""
               |		ИНАЧЕ """"
               |	КОНЕЦ КАК СтатусДокумента,
               |	DR_Документ.Грузоотправитель КАК Грузоотправитель,
               |	DR_Документ.Грузополучатель КАК Грузополучатель,
               |	DR_Документ.Грузоперевозчик КАК Грузоперевозчик,
               |	DR_Документ.Организация КАК Организация,
               |	ЕСТЬNULL(DR_Документ_ON_TRNPUDPER_Исходящий.Накладная, """") КАК Накладная,
               |	ВЫБОР
               |		КОГДА DR_Документ_ON_TRNACLPPRIN_Исходящий.ДополнительнаяИнформация_aperakETRN = ИСТИНА
               |				ИЛИ DR_Документ_ON_TRNACLPVYN_Исходящий.ДополнительнаяИнформация_aperakETRN = ИСТИНА
               |				ИЛИ DR_Документ_DP_UVUTOCH_Исходящий.ДополнительнаяИнформация_aperakETRN = ИСТИНА
               |				ИЛИ DR_Документ_ON_TRNPEREADR_Исходящий.ДополнительнаяИнформация_aperakETRN = ИСТИНА
               |				ИЛИ DR_Документ_ON_TRNZAMEN_Исходящий.ДополнительнаяИнформация_aperakETRN = ИСТИНА
               |				ИЛИ DR_Документ_ON_TRNPUDPER_Исходящий.ДополнительнаяИнформация_aperakETRN = ИСТИНА
               |			ТОГДА ИСТИНА
               |		ИНАЧЕ ЛОЖЬ
               |	КОНЕЦ КАК ДополнительнаяИнформация_aperakETRN
               |ИЗ
               |	ВТ_ON_TRNACLGROT КАК DR_Документ
               |		ЛЕВОЕ СОЕДИНЕНИЕ ВТ_DP_UVUTOCH_Исх КАК DR_Документ_DP_UVUTOCH_Исходящий
               |		ПО DR_Документ.ИдентификаторДокумента = DR_Документ_DP_UVUTOCH_Исходящий.ИдентификаторОснования
               |		ЛЕВОЕ СОЕДИНЕНИЕ ВТ_ON_TRNACLPPRIN КАК DR_Документ_ON_TRNACLPPRIN_Исходящий
               |			ЛЕВОЕ СОЕДИНЕНИЕ ВТ_ON_TRNACLGRPO КАК DR_Документ_ON_TRNACLGRPO_Входящий
               |				ЛЕВОЕ СОЕДИНЕНИЕ ВТ_ON_TRNACLPVYN КАК DR_Документ_ON_TRNACLPVYN_Исходящий
               |				ПО DR_Документ_ON_TRNACLGRPO_Входящий.ИдентификаторДокумента = DR_Документ_ON_TRNACLPVYN_Исходящий.ИдентификаторОснования
               |				ЛЕВОЕ СОЕДИНЕНИЕ ВТ_ON_TRNPUDPER КАК DR_Документ_ON_TRNPUDPER_Исходящий
               |				ПО (DR_Документ_ON_TRNACLPVYN_Исходящий.ИдентификаторДокумента = DR_Документ_ON_TRNPUDPER_Исходящий.ИдентификаторОснования)
               |				ЛЕВОЕ СОЕДИНЕНИЕ ВТ_DP_UVUTOCH_Вх КАК DR_Документ_DP_UVUTOCH_Входящий
               |				ПО (DR_Документ_ON_TRNPUDPER_Исходящий.ИдентификаторДокумента = DR_Документ_DP_UVUTOCH_Входящий.ИдентификаторОснования)
               |				ЛЕВОЕ СОЕДИНЕНИЕ ВТ_ON_TRNPUDGO КАК DR_Документ_ON_TRNPUDGO_Входящий
               |				ПО (DR_Документ_ON_TRNPUDPER_Исходящий.ИдентификаторДокумента = DR_Документ_ON_TRNPUDGO_Входящий.ИдентификаторОснования)
               |			ПО DR_Документ_ON_TRNACLPPRIN_Исходящий.ИдентификаторДокумента = DR_Документ_ON_TRNACLGRPO_Входящий.ИдентификаторОснования
               |			ЛЕВОЕ СОЕДИНЕНИЕ ВТ_ON_TRNPEREADR КАК DR_Документ_ON_TRNPEREADR_Исходящий
               |			ПО DR_Документ_ON_TRNACLPPRIN_Исходящий.ИдентификаторДокумента = DR_Документ_ON_TRNPEREADR_Исходящий.ИдентификаторОснования
               |			ЛЕВОЕ СОЕДИНЕНИЕ ВТ_ON_TRNZAMEN КАК DR_Документ_ON_TRNZAMEN_Исходящий
               |			ПО DR_Документ_ON_TRNACLPPRIN_Исходящий.ИдентификаторДокумента = DR_Документ_ON_TRNZAMEN_Исходящий.ИдентификаторОснования
               |		ПО DR_Документ.ИдентификаторДокумента = DR_Документ_ON_TRNACLPPRIN_Исходящий.ИдентификаторОснования
               |
               |УПОРЯДОЧИТЬ ПО
               |	НАЧАЛОПЕРИОДА(DR_Документ.ДатаЭТРН, ДЕНЬ)";
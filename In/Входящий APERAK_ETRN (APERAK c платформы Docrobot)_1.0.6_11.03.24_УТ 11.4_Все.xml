<ValueTree xmlns="http://v8.1c.ru/8.1/data/core" xmlns:xs="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:type="ValueTree">
	<column>
		<Name xsi:type="xs:string">Использовать</Name>
		<ValueType/>
	</column>
	<column>
		<Name xsi:type="xs:string">ТипТранзакции</Name>
		<ValueType/>
	</column>
	<column>
		<Name xsi:type="xs:string">Служебные</Name>
		<ValueType/>
	</column>
	<column>
		<Name xsi:type="xs:string">СлужебныеТекст</Name>
		<ValueType/>
	</column>
	<column>
		<Name xsi:type="xs:string">Сохранение</Name>
		<ValueType/>
	</column>
	<column>
		<Name xsi:type="xs:string">Загрузка</Name>
		<ValueType/>
	</column>
	<column>
		<Name xsi:type="xs:string">Кнопка</Name>
		<ValueType/>
	</column>
	<column>
		<Name xsi:type="xs:string">КоллекцияТЧ</Name>
		<ValueType/>
	</column>
	<row>
		<Value xsi:type="xs:boolean">true</Value>
		<Value xsi:type="xs:string">Входящий APERAK_ETRN (APERAK c платформы Docrobot)</Value>
		<Value xsi:type="xs:string">	СтруктураДок = Приемник.ДанныеФайла.Получить();		                       
	СписокРеквизитов = Новый Соответствие;	
	ТЧДополнительныеРеквизиты = Настройка_Параметр_Прочитать("ЭТРН_ДополнительныеРеквизиты"); 
	
	СрокОбработки = (НачалоДня(ТекущаяДата()) - НачалоДня(Приемник.Дата)) / 86400;
	
	Если СрокОбработки &gt; 7 Тогда
		
		Приемник.Статус = "Обработан";
		
		Попытка
			Приемник.Записать(РежимЗаписиДокумента.Запись);
		Исключение
			
		КонецПопытки; 
		
	Иначе
		
		Приемник.ДополнительныеРеквизиты.Очистить();
		Приемник.Сообщение = "";          
		
		Для Каждого СтрокаСтруктура Из СтруктураДок Цикл	
			
			Реквизит = ВернутьСоответствиеДопРеквизита(СтрокаСтруктура.Ключ, Приемник.ВидДокумента, ТЧДополнительныеРеквизиты);
			
			Если ТипЗнч(СтрокаСтруктура.Значение) = Тип("Массив") Тогда          
				
				ЗначениеРеквизита = "";
				Для Каждого ЭлМассива Из СтрокаСтруктура.Значение Цикл
					ЗначениеРеквизита = ЗначениеРеквизита + ЭлМассива + Символы.ПС; 
				КонецЦикла;
				СписокРеквизитов.Вставить(Реквизит, ЗначениеРеквизита);
				
			Иначе	
				
				СписокРеквизитов.Вставить(Реквизит, СтрокаСтруктура.Значение);				          
				
			КонецЕсли;     
			
		КонецЦикла;  
		
		УИдОснования = СписокРеквизитов.Получить("УИдОснования");
		
		Если Не УИдОснования = Неопределено Тогда 			
			
			СписокРеквизитовДляЗаписи = Новый Соответствие;
			СписокРеквизитовДляЗаписи.Вставить("СтатусОбработкиDocrobot", СписокРеквизитов.Получить("СтатусОбработкиDocrobot")); 
			СписокРеквизитовДляЗаписи.Вставить("ИнформационноеСообщениеDocrobot", СписокРеквизитов.Получить("ИнформационноеСообщениеDocrobot"));
			СписокРеквизитовДляЗаписи.Вставить("ДополнительнаяИнформация_aperakETRN", Ложь);
			
			//Ищем титул-основание
			Запрос = Новый Запрос;	
			Запрос.Текст = "ВЫБРАТЬ
			|	DR_Документы.Ссылка КАК Ссылка,
			|   DR_Документы.ВидДокумента
			|ИЗ
			|	Документ.DR_Документы КАК DR_Документы
			|ГДЕ
			|	DR_Документы.ИдентификаторДокумента = &amp;ИдентификаторДокумента";
			
			Запрос.УстановитьПараметр("ИдентификаторДокумента", УИдОснования);
			ВыборкаДетальныеЗаписи = Запрос.Выполнить().Выбрать();
			
			Пока ВыборкаДетальныеЗаписи.Следующий() Цикл 
				Если Найти(ВыборкаДетальныеЗаписи.ВидДокумента, "_Входящий") > 0 Тогда
					Продолжить;
				КонецЕсли;
 			
				ДокОснование = ВыборкаДетальныеЗаписи.Ссылка.ПолучитьОбъект();
				
				Если СписокРеквизитовДляЗаписи.Получить("СтатусОбработкиDocrobot") = "OK" Тогда 
					ДокОснование.Статус = "Принят Docrobot";
					
					Если Не СокрЛП(СписокРеквизитовДляЗаписи.Получить("ИнформационноеСообщениеDocrobot")) = "Документ успешно обработан" Тогда
						СписокРеквизитовДляЗаписи.Вставить("ДополнительнаяИнформация_aperakETRN", Истина);	
					КонецЕсли;
					
				ИначеЕсли СписокРеквизитовДляЗаписи.Получить("СтатусОбработкиDocrobot") = "ERR" Тогда 
					ДокОснование.Статус = "Отклонен Docrobot"; 
				Иначе
					Продолжить;
				КонецЕсли; 
				
				Для Каждого Запись из СписокРеквизитовДляЗаписи Цикл
					
					Отбор = Новый Структура;
					Отбор.Вставить("Реквизит", Запись.Ключ);
					
					СтрокиПоиск = ДокОснование.ДополнительныеРеквизиты.НайтиСтроки(Отбор);
					Если СтрокиПоиск.Количество() Тогда
						НоваяЗапись = СтрокиПоиск[0];	
					Иначе
						НоваяЗапись = ДокОснование.ДополнительныеРеквизиты.Добавить();
					КонецЕсли;
					
					НоваяЗапись.Реквизит = Запись.Ключ;
					НоваяЗапись.Значение = Запись.Значение;
				КонецЦикла;  
				
				Попытка
					ДокОснование.Записать(РежимЗаписиДокумента.Запись);
				Исключение
					
				КонецПопытки;
				
				Приемник.Статус = "Обработан";        
				
				Попытка
					Приемник.Записать(РежимЗаписиДокумента.Запись);
				Исключение
					
				КонецПопытки; 
				
			КонецЦикла;
			
		КонецЕсли;   
		
	КонецЕсли; </Value>
		<Value xsi:type="xs:string"/>
		<Value xsi:type="xs:decimal">0</Value>
		<Value xsi:type="xs:decimal">0</Value>
		<Value xsi:type="xs:string">Получить APERAK</Value>
		<Value xsi:type="ValueListType">
			<valueType/>
			<lastId xsi:type="xs:decimal">5</lastId>
			<item>
				<value xsi:type="xs:string">ДополнительныйПолучатель</value>
				<id xsi:type="xs:decimal">0</id>
			</item>
			<item>
				<value xsi:type="xs:string">Грузоперевозчик</value>
				<checkState>1</checkState>
				<id xsi:type="xs:decimal">1</id>
			</item>
			<item>
				<value xsi:type="xs:string">Грузополучатель</value>
				<checkState>1</checkState>
				<id xsi:type="xs:decimal">2</id>
			</item>
			<item>
				<value xsi:type="xs:string">Грузоотправитель</value>
				<checkState>1</checkState>
				<id xsi:type="xs:decimal">3</id>
			</item>
			<item>
				<value xsi:type="xs:string">Синоним</value>
				<presentation>Получить APERAK</presentation>
				<id xsi:type="xs:decimal">4</id>
			</item>
			<item>
				<value xsi:type="xs:string">ИмяКнопки</value>
				<presentation>APERAK_ETRN_In</presentation>
				<checkState>1</checkState>
				<id xsi:type="xs:decimal">5</id>
			</item>
		</Value>
	</row>
</ValueTree>